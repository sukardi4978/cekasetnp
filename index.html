<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aplikasi Cek Aset</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #f5f5f5;
    }
    h2 {
      margin-bottom: 10px;
    }
    input {
      padding: 6px;
      font-size: 14px;
      width: 280px;
    }
    button {
      padding: 6px 12px;
      font-size: 14px;
      margin-left: 6px;
    }
    pre {
      background: white;
      padding: 15px;
      border: 1px solid #ccc;
      margin-top: 20px;
      white-space: pre-wrap;
      line-height: 1.5em;
    }
  </style>
</head>
<body>
  <h2>üîç Cek Aset</h2>
  <input id="kodeInput" type="text" placeholder="Masukkan kode aset">
  <button onclick="searchAsset()">Cari</button>

  <pre id="result">Hasil pencarian akan muncul di sini...</pre>

  <script>
    // Ganti dengan link JSON dari opensheet.elk.sh
    const sheetURL = "https://opensheet.elk.sh/SPREADSHEET_ID/Sheet1";
    let assets = [];

    // Ambil data dari Google Sheet
    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        assets = data;
        console.log("Data aset berhasil dimuat:", assets);
      })
      .catch(err => {
        console.error("Gagal memuat data aset:", err);
      });

    function searchAsset() {
      const kode = document.getElementById("kodeInput").value.trim().toLowerCase();
      const resultBox = document.getElementById("result");

      if (!kode) {
        resultBox.textContent = "‚ùó Silakan masukkan kode aset.";
        return;
      }

      const aset = assets.find(a => (a["Data Aset"] || "").toLowerCase() === kode);

      if (aset) {
        // Susun hasil dengan rata kiri dan ":" lurus ke bawah
        let output = "";
        output += `Data Aset       : ${aset["Data Aset"] || "-"}\n`;
        output += `Deskripsi       : ${aset["Deskripsi"] || "-"}\n`;
        output += `Kapitalisasi    : ${aset["Kapitalisasi"] || "-"}\n`;
        output += `Nilai Perolehan : ${aset["Nilai Perolehan"] || "-"}\n`;
        output += `Lokasi          : ${aset["Lokasi"] || "-"}\n`;
        output += `Detail Lokasi   : ${aset["Detail Lokasi"] || "-"}\n`;
        output += `Opname Terakhir : ${aset["Opname Terakhir"] || "-"}\n`;
        output += `Kondisi         : ${aset["Kondisi"] || "-"}\n`;
        output += `Catatan         : ${aset["Catatan"] || "-"}\n`;

        resultBox.textContent = output;
      } else {
        resultBox.textContent = `‚ùå Aset dengan kode "${kode}" tidak ditemukan.`;
      }
    }
  </script>
</body>
</html>