<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Pencarian Data Aset</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
    #searchBox { width: 300px; padding: 10px; font-size: 16px; }
    #output { margin-top: 20px; text-align: left; display: inline-block; border: 1px solid #ccc; padding: 10px; white-space: pre-wrap; }
    #output pre { margin: 0; font-size: 16px; line-height: 1.3; font-family: "Courier New", Courier, monospace; } /* monospace -> ":" sejajar */
  </style>
</head>
<body>
  <h2>Cek Data Aset</h2>
  <input type="text" id="searchBox" placeholder="Masukkan Data Aset..." list="assetList" autocomplete="off">
  <datalist id="assetList"></datalist>
  <div id="output"></div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNRyfw_yykeThKKpZzMy86gTB3FPHMEFfn93BGjMfxL2mcH68dQwc6Q4D-7X8Gl41vAbUdMCa7jMCt/pub?output=csv";
    let assets = [];

    async function loadSheet() {
      const response = await fetch(sheetUrl);
      const data = await response.text();
      const rows = data.split("\n").map(r =>
        r.split(/,(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/).map(c => c.replace(/^"|"$/g, ""))
      );
      rows.shift(); // hapus header

      // mapping baris ke objek
      assets = rows.map(r => ({
        kode: r[1] || "",
        deskripsi: r[2] || "",
        kapitalisasi: r[3] || "",
        perolehan: r[4] || "",
        lokasi: r[5] || "",
        detail: r[6] || "",
        opname: r[18] || "",
        kondisi: r[19] || "",
        catatan: r[16] ? r[16] : (r[21] || "")   // Q kalau ada, kosong -> V
      }));

      const dataList = document.getElementById("assetList");
      assets.forEach(a => {
        if (a.kode) {
          const option = document.createElement("option");
          option.value = a.kode;
          dataList.appendChild(option);
        }
      });
    }

    document.getElementById("searchBox").addEventListener("keypress", function(e) {
      if (e.key === "Enter") searchAsset();
    });

    function searchAsset() {
      let input = document.getElementById("searchBox").value.trim();
      if (input.length === 8 && !input.includes("-")) input += "-0";
      const asset = assets.find(a => a.kode === input);
      document.getElementById("output").innerHTML = asset ? formatAsset(asset) : "<pre>Data tidak ditemukan</pre>";
    }

    function formatAsset(a) {
      const rows = [
        ["Data Aset", a.kode],
        ["Deskripsi", a.deskripsi],
        ["Kapitalisasi", a.kapitalisasi],
        ["Nilai Perolehan", a.perolehan],
        ["Lokasi", a.lokasi],
        ["Detail Lokasi", a.detail],
        ["Opname Terakhir", a.opname],
        ["Kondisi", a.kondisi],
        ["Catatan", a.catatan]
      ];

      // Lebar label terpanjang -> padding dinamis
      const maxLabelLen = Math.max(...rows.map(([label]) => label.length));
      const lines = rows.map(([label, val]) => label.padEnd(maxLabelLen, " ") + " : " + (val || ""));

      return `<pre>${lines.join("\n")}</pre>`;
    }

    loadSheet();
  </script>
</body>
</html>