<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Pencarian Data Aset</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
    #searchBox { width: 300px; padding: 10px; font-size: 16px; }
    #output { 
      margin-top: 20px; 
      text-align: left; 
      display: inline-block; 
      border: 1px solid #ccc; 
      padding: 10px; 
    }
    .asset-table {
      display: grid;
      grid-template-columns: 180px auto; /* lebar label dan isi */
      row-gap: 6px;
      column-gap: 10px;
      font-size: 16px;
      line-height: 1.3;
    }
    .label { font-weight: bold; }
  </style>
</head>
<body>
  <h2>Cek Data Aset</h2>
  <input type="text" id="searchBox" placeholder="Masukkan Data Aset..." list="assetList" autocomplete="off">
  <datalist id="assetList"></datalist>
  <div id="output"></div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNRyfw_yykeThKKpZzMy86gTB3FPHMEFfn93BGjMfxL2mcH68dQwc6Q4D-7X8Gl41vAbUdMCa7jMCt/pub?output=csv";
    let assets = [];

    async function loadSheet() {
      const response = await fetch(sheetUrl);
      const data = await response.text();
      const rows = data.split("\n").map(r => 
        r.split(/,(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/).map(c => c.replace(/^"|"$/g, ""))
      );
      rows.shift(); // hapus header

      assets = rows.map(r => ({
        kode: r[1] || "",
        deskripsi: r[2] || "",
        kapitalisasi: r[3] || "",
        perolehan: r[4] || "",
        lokasi: r[5] || "",
        detail: r[6] || "",
        opname: r[18] || "",
        kondisi: r[19] || "",
        catatan: r[16] ? r[16] : (r[21] || "")
      }));

      const dataList = document.getElementById("assetList");
      assets.forEach(a => {
        if (a.kode) {
          let option = document.createElement("option");
          option.value = a.kode;
          dataList.appendChild(option);
        }
      });
    }

    document.getElementById("searchBox").addEventListener("keypress", function(e) {
      if (e.key === "Enter") searchAsset();
    });

    function searchAsset() {
      let input = document.getElementById("searchBox").value.trim();
      if (input.length === 8 && !input.includes("-")) input += "-0";
      const asset = assets.find(a => a.kode === input);
      document.getElementById("output").innerHTML = asset ? formatAsset(asset) : "<pre>Data tidak ditemukan</pre>";
    }

    function formatAsset(a) {
      return `
        <div class="asset-table">
          <div class="label">Data Aset</div><div>: ${a.kode}</div>
          <div class="label">Deskripsi</div><div>: ${a.deskripsi}</div>
          <div class="label">Kapitalisasi</div><div>: ${a.kapitalisasi}</div>
          <div class="label">Nilai Perolehan</div><div>: ${a.perolehan}</div>
          <div class="label">Lokasi</div><div>: ${a.lokasi}</div>
          <div class="label">Detail Lokasi</div><div>: ${a.detail}</div>
          <div class="label">Opname Terakhir</div><div>: ${a.opname}</div>
          <div class="label">Kondisi</div><div>: ${a.kondisi}</div>
          <div class="label">Catatan</div><div>: ${a.catatan}</div>
        </div>
      `;
    }

    loadSheet();
  </script>
</body>
</html>