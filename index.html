<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Cek Aset</title>
</head>
<body>
  <h2>Cek Aset</h2>
  <input type="text" id="searchBox" placeholder="Masukkan Kode Aset">
  <button onclick="searchAsset()">Cari</button>

  <div id="assetResult" style="margin-top:20px;"></div>

  <script>
    // Ganti dengan URL JSON dari Google Sheets (Publish to Web -> CSV -> convert ke JSON pakai link)
    const sheetURL = "https://opensheet.elk.sh/1k4y2SAMPLEID/sheet1"; 

    async function searchAsset() {
      const kodeInput = document.getElementById("searchBox").value.trim();
      if (!kodeInput) {
        alert("Masukkan kode aset terlebih dahulu!");
        return;
      }

      try {
        const response = await fetch(sheetURL);
        const data = await response.json();

        // cari aset berdasarkan kode
        const asset = data.find(row => row["Data Aset"] === kodeInput);

        if (asset) {
          displayAsset(asset);
        } else {
          document.getElementById("assetResult").innerHTML = 
            "<p>Aset tidak ditemukan.</p>";
        }
      } catch (error) {
        console.error(error);
        document.getElementById("assetResult").innerHTML = 
          "<p>Gagal mengambil data.</p>";
      }
    }

    function displayAsset(asset) {
      document.getElementById("assetResult").innerHTML = `
        <table style="border-collapse: collapse; text-align: left;">
          <tr><td style="padding:2px;">Data Aset</td><td style="padding:2px;">:</td><td style="padding:2px;">${asset["Data Aset"]}</td></tr>
          <tr><td style="padding:2px;">Deskripsi</td><td>:</td><td>${asset.Deskripsi}</td></tr>
          <tr><td style="padding:2px;">Kapitalisasi</td><td>:</td><td>${asset.Kapitalisasi}</td></tr>
          <tr><td style="padding:2px;">Nilai Perolehan</td><td>:</td><td>${asset["Nilai Perolehan"]}</td></tr>
          <tr><td style="padding:2px;">Lokasi</td><td>:</td><td>${asset.Lokasi}</td></tr>
          <tr><td style="padding:2px;">Detail Lokasi</td><td>:</td><td>${asset["Detail Lokasi"]}</td></tr>
          <tr><td style="padding:2px;">Opname Terakhir</td><td>:</td><td>${asset["Opname Terakhir"]}</td></tr>
          <tr><td style="padding:2px;">Kondisi</td><td>:</td><td>${asset.Kondisi}</td></tr>
          <tr><td style="padding:2px;" colspan="3">${asset.Catatan || ""}</td></tr>
        </table>
      `;
    }
  </script>
</body>
</html>