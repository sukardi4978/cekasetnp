
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cek Aset Mini CSV</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
  h2 { color: #333; }
  .search-container { position: relative; display: inline-block; margin-bottom: 20px; }
  input[type=text] { width: 300px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
  button { padding: 10px 14px; margin-left: 5px; cursor: pointer; border: none; border-radius: 4px; background: #4CAF50; color: #fff; font-size: 16px; }
  button:hover { background: #45a049; }
  .autocomplete-suggestions { border: 1px solid #ccc; max-height: 150px; overflow-y: auto; position: absolute; background: #fff; z-index: 1000; width: 300px; border-radius: 4px; }
  .autocomplete-suggestion { padding: 6px 10px; cursor: pointer; }
  .autocomplete-suggestion:hover { background-color: #f0f0f0; }
  .result { margin-top: 20px; max-width: 650px; }
  .card { background: #fff; border-radius: 6px; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  table { width: 100%; border-collapse: collapse; }
  td { padding: 6px 8px; vertical-align: top; }
  td.label { font-weight: bold; width: 150px; color: #555; }
  tr:hover { background-color: #f0f8ff; }
  .keterangan { max-height: 150px; overflow-y: auto; padding-top: 4px; white-space: pre-line; color: #333; }
</style>
</head>
<body>
<h2>Cek Aset Mini CSV</h2>
<div class="search-container">
  <input type="text" id="kodeAset" placeholder="Masukkan Kode Aset">
  <button id="btnCari">üîç</button>
  <div id="autocomplete-list" class="autocomplete-suggestions"></div>
</div>

<div class="result" id="result"></div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/1u-gbTU-RAnGNc_Yl21PNJPsKRJ-b_ahrY5_2FGHsMAE/export?format=csv&sheet=Sheet5";

let data = [];

Papa.parse(CSV_URL, {
  download: true,
  header: true,
  complete: function(results) {
    data = results.data;
  }
});

const input = document.getElementById("kodeAset");
const btn = document.getElementById("btnCari");
const resultDiv = document.getElementById("result");
const autocompleteList = document.getElementById("autocomplete-list");

function tampilkanHasil(row) {
  if (!row) {
    resultDiv.innerHTML = "<p>Data tidak ditemukan.</p>";
    return;
  }
  const kode = row["E"]||"";
  const cardHTML = `
    <div class="card">
      <table>
        <tr><td class="label">Kode Aset</td><td>${kode}</td></tr>
        <tr><td class="label">Deskripsi</td><td>${row["F"]||""}</td></tr>
        <tr><td class="label">Kapitalisasi</td><td>${row["G"]||""}</td></tr>
        <tr><td class="label">Nilai Perolehan</td><td>${row["T"]||""}</td></tr>
        <tr><td class="label">Lokasi</td><td>${row["N"]||""}</td></tr>
        <tr><td class="label">Detail Lokasi</td><td>${row["O"]||""}</td></tr>
        <tr><td class="label">Kondisi</td><td>${row["P"]||""}</td></tr>
        <tr><td class="label">Opname Terakhir</td><td>${row["K"]||row["J"]||""}</td></tr>
        <tr><td colspan="2"><div class="keterangan">${row["Q"]||row["U"]||""}</div></td></tr>
      </table>
    </div>
  `;
  resultDiv.innerHTML = cardHTML;
}

function cariKodeAset() {
  let kode = input.value.trim();
  if (/^\d{8}$/.test(kode)) kode += "-0";
  const row = data.find(r => r["E"]===kode || (r["E"]===kode.replace("-0","") && kode.endsWith("-0")));
  tampilkanHasil(row);
}

btn.addEventListener("click", cariKodeAset);
input.addEventListener("keydown", e => { if(e.key==="Enter") cariKodeAset(); });

input.addEventListener("input", () => {
  const val = input.value.trim();
  autocompleteList.innerHTML = "";
  if (!val) return;
  const suggestions = data
    .map(r=>r["E"])
    .filter(k=>k && k.startsWith(val))
    .slice(0,10);
  suggestions.forEach(s=>{
    const div = document.createElement("div");
    div.textContent = s;
    div.classList.add("autocomplete-suggestion");
    div.addEventListener("click", ()=>{
      input.value = s;
      autocompleteList.innerHTML = "";
    });
    autocompleteList.appendChild(div);
  });
});

document.addEventListener("click", e => { if(e.target!==input) autocompleteList.innerHTML=""; });
</script>
</body>
</html>
